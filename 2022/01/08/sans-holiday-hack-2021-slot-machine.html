<!doctype html>
<html lang="en-GB">
<head>
	<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "BlogPosting",
		  "headline": "SANS Holiday Hack Challenge 2021&#58; Slot machine walkthrough",
		  "description": "Here‚Äôs one more writeup from the SANS Holiday Hack Challenge! The slot machine hack was one of the showpiece challenges this year, so I thought I‚Äôd put together a quick blog post to guide you through the process of identifying and exploiting a vul...",
		  "author": {
		    "@type": "Person",
		    "name": "Matt C. A. Smith",
		    "url": "https://mattcasmith.net/about.htm"
		  },
		  "datePublished": "2022-01-08",
		  "dateModified": "2022-01-08",
		  "image": "https://mattcasmith.net/wp-content/uploads/2022/01/sans-holiday-challenge-slots_1.png",
		  "publisher": {
		    "@type": "Organization",
		    "name": "MattCASmith",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://mattcasmith.net/assets/images/mcas_site_logo.png"
		    }
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://mattcasmith.net/2022/01/08/sans-holiday-hack-2021-slot-machine"
		  }
		}
	</script>
	<meta name="description" content="Here‚Äôs one more writeup from the SANS Holiday Hack Challenge! The slot machine hack was one of the showpiece challenges this year, so I thought I‚Äôd put together a quick blog post to guide you through the process of identifying and exploiting a vul..." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2022/01/08/sans-holiday-hack-2021-slot-machine" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="SANS Holiday Hack Challenge 2021&#58; Slot machine walkthrough | MattCASmith" />
	<meta property="og:description" content="Here‚Äôs one more writeup from the SANS Holiday Hack Challenge! The slot machine hack was one of the showpiece challenges this year, so I thought I‚Äôd put together a quick blog post to guide you through the process of identifying and exploiting a vul..." />
	<meta property="og:url" content="https://mattcasmith.net/2022/01/08/sans-holiday-hack-2021-slot-machine" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2022-01-08T00:01:00+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2022/01/sans-holiday-challenge-slots_1.png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
	<meta name="twitter:image" content="https://mattcasmith.net/wp-content/uploads/2022/01/sans-holiday-challenge-slots_1.png" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>SANS Holiday Hack Challenge 2021&#58; Slot machine walkthrough | MattCASmith</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about light" src="/assets/images/about_icon.png" alt="About MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about dark" src="/assets/images/about_icon_dark.png" alt="About MattCASmith"></a>
			</div>
			<div id="search_cont">
				<input id="search" name="search" placeholder="Search site..." value="">
			</div>
		</div>
		
		<article class="post">

			<nav class="top_nav">
				<a href="/">HOME</a>
				<a href="/category/technology" >TECHNOLOGY</a>
				<a href="/category/business" >BUSINESS</a>
				<a href="/category/productivity" >PRODUCTIVITY</a>
				<a href="/category/design" >DESIGN</a>
				<a href="/category/cyber-security" >CYBER SECURITY</a>
				<a href="/category/programming" >CODING</a>
				<a href="/category/off-topic" >MISC</a>
			</nav>	

			<div class="title">
				<h1 class="entry-title">SANS Holiday Hack Challenge 2021&#58; Slot machine walkthrough</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2022-01-08</span>&nbsp; 
					
					
						<a href="/category/cyber-security/">Cyber Security</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p>Here‚Äôs one more writeup from the <a href="https://www.sans.org/mlp/holiday-hack-challenge/" target="_blank">SANS Holiday Hack Challenge</a>! The slot machine hack was one of the showpiece challenges this year, so I thought I‚Äôd put together a quick blog post to guide you through the process of identifying and exploiting a vulnerability in the game.</p>

<h3 id="the-challenge">The challenge</h3>

<p>Our task is clear enough. We‚Äôre given a link to an online slot machine and the following request:</p>

<blockquote>
  <p>Test the security of Jack Frost‚Äôs slot machines. What does the Jack Frost Tower casino security team threaten to do when your coin total exceeds 1,000? Submit the string in the server <code>data.response</code> element.</p>
</blockquote>

<p>Let‚Äôs follow the link and take a look at the slot machine. It‚Äôs fairly typical for such games (at least as per my understanding following <a href="/2019/08/26/im-back-def-con-inspired-hacking/">a short trip to Las Vegas for Black Hat and Def Con</a>). You can choose various options before placing a bet by hitting the Spin button. Your credit is updated based on the outcome.</p>

<p><img src="/wp-content/uploads/2022/01/sans-holiday-challenge-slots_1.png" /></p>

<p>Since our objective is to hit more than 1,000 credit, we <em>could</em> just play the slots for a long time to try to get lucky. But that would take forever. Instead, let‚Äôs take under the hood to see what we can hack‚Ä¶</p>

<h3 id="observing-requests">Observing requests</h3>

<p>Like any web application, the slot machine must be communicating with a server behind the scenes to make playing the game possible. By using the Burp Suite proxy‚Äôs intercept function, we can hold requests and responses between the web browser and the server to give us time to review their contents and see what‚Äôs going on when we place a bet. Here‚Äôs what is sent when we hit the Spin button‚Ä¶</p>

<p><img src="/wp-content/uploads/2022/01/sans-holiday-challenge-slots_2.png" /></p>

<p>This looks like a pretty standard web request. We can see that this is a <code>POST</code> request, which means that the client is transmitting information to the server (<code>slots.jackfrosttower.com</code>). We can see that the request provides some cookie information, details about the page we‚Äôre on and our user agent, and so on. This is all pretty normal for this kind of request. But what about that last line?</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">betamount</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">numline</span><span class="o">=</span><span class="mi">20</span><span class="o">&amp;</span><span class="n">cpl</span><span class="o">=</span><span class="mf">0.1</span></code></pre></figure>

<p>Comparing these variable names to the GUI, we can ascertain that this is our browser telling the server how much we‚Äôre betting, the number of lines we‚Äôre betting on, and the cost per line. Interesting. By tweaking these values, we might be able to:</p>

<ul>
  <li>Change the bet amount to a bigger stake than we can actually afford</li>
  <li>Bet on more lines than actually exist on the slot machine</li>
  <li>Adjust the cost per line to alter the slot machine‚Äôs financial calculations</li>
</ul>

<p>From here, it‚Äôs a matter of trial and error. Attempting the first two potential exploits returns a <code>Server Error</code> response. That leaves only one option - but how can we use the <code>cpl</code> variable to our advantage?</p>

<h3 id="crafting-a-malicious-request">Crafting a malicious request</h3>

<p>So here‚Äôs the plan: We‚Äôre going to set <code>cpl</code> to a negative value to confuse the game if this input isn‚Äôt validated. For example, if we set it to <code>-100</code> and there are 20 lines to play, that spin would cost us -2,000 credits to play and therefore actually <em>increase</em> our credit by 2,000 (and any winnings from the spin).</p>

<p>To do this, we hit the Spin button on the slot machine‚Äôs GUI. Burp Suite intercepts the request. We must very quickly change the <code>cpl</code> value to <code>-100</code> and hit the Forward button before the spin times out.</p>

<p><img src="/wp-content/uploads/2022/01/sans-holiday-challenge-slots_3.png" /></p>

<p>It looks like the server doesn‚Äôt check that <code>cpl</code> is set to a valid value before executing the spin. All goes to plan and when the play is complete our credit is now in the thousands! Mission complete - almost.</p>

<p>Our task was actually to find a value in the JSON response once our credit exceeds 1,000. To do this, we can take a look for the relevant request and response on Burp Suite‚Äôs HTTP history page. Sure enough, in the <code>data.response</code> field, we can see the following message from casino security:</p>

<p><img src="/wp-content/uploads/2022/01/sans-holiday-challenge-slots_4.png" /></p>

<p>And that‚Äôs our flag: <code>I'm going to have some bouncer trolls bounce you right out of this casino!</code> Hopefully we have enough time to submit it and take the credit for our hacking first.</p>

<p>If you found this walkthrough interesting, please consider <a href="https://twitter.com/mattcasmith" target="_blank">following me on Twitter</a>, and don‚Äôt forget to sign up for the next SANS Holiday Hack Challenge circa December 2022!</p>

					<div id="newsletter_post">
	<h3>Field Notes // A newsletter by MattCASmith</h3>
	<p>A monthly collection of observations, ideas in progress,<br />and the best books, podcasts, and articles I discover</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<a href="https://mattcasmith.beehiiv.com/subscribe" target="_blank">
<div id="newsletter_sidebar">
	<table>
		<tr>
			<td>
				<h3>üìì</h3>
			</td>
			<td>	
				<h2>Field Notes newsletter</h2>
			</td>
		</tr>
	</table>
	<p>A monthly collection of observations, ideas in progress, and the best books, podcasts, and articles I discover</p>
	<button>Subscribe</button>
</div>
</a>
<p class="newsletter_disclaimer">No spam. Unsubscribe anytime.</p>
				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/technology"><li class="first">Technology</li></a>
		<a href="/category/business"><li>Business</li></a>
		<a href="/category/productivity"><li>Productivity</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/cyber-security"><li>Cyber Security</li></a>
		<a href="/category/programming"><li>Coding</li></a>
		<a href="/category/off-topic"><li>Miscellaneous</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & pages</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/about.htm" class="home-index"><li class="first">About</li></a>
		<a href="/recommendations.htm" class="home-index"><li>Recommendations</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/13/you-can-just-do-things-kind-of">
				                        			<li class="first">A reminder that you can just do things... kind of</li>
					    	                	</a>
					    	                	
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/10/ai-shopping-profiling-privacy">
				                        			<li>AI shopping only works if you give up your privacy</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/01/self-driving-cars-buying-broken">
				                        			<li>Self-driving cars are here, but the friction is in the sale</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/09/field-notes-5-november-2025">
				                        			<li>Field Notes 5 // ChatGPT Atlas and the Claude cafeÃÅ</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li>Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/19/ai-security-operations-untapped-potential">
				                        			<li>The untapped potential of AI for security operations</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/11/field-notes-4-october-2025">
				                        			<li>Field Notes 4 // New York, note taking, and Blindr</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/05/anthropic-claude-ai-marketing-design">
				                        			<li>Claude's caf√© pop-up convinced me to switch LLMs</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/04/21/chatgpt-ai-anthropomorphism">
				                        			<li>Humanising AI encourages intellectual lethargy</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/26/etherhiding-blockchain-malware">
				                        			<li>EtherHiding&#58; When good blockchains turn bad</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/21/note-taking-waste-less-time-online">
				                        			<li>Take note&#58; How to waste less time on the internet</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/23/best-of-tech-2025">
				                        			<li>Best of Tech 2025&#58; Gadgets, books, games, and more</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/10/03/new-york-observations-recommendations">
				                        			<li>New York City&#58; Observations and recommendations</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/01/state-of-the-blog-2026">
				                        			<li>State of the Blog 2026&#58; Following a new direction</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2022/01/08/sans-holiday-hack-2021-yara-rules">&laquo;&nbsp;SANS Holiday Hack Challenge 2021&#58; Yara rule analysis walkthrough</a>
					
			</div>
			<div class="next">
			    
					<a href="/2022/02/22/bash-history-basics-behaviours-forensics">Linux .bash&#95;history&#58; Basics, behaviours, and forensics&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-26 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script>
        	/* Search - allow submission using Enter key */
			document.getElementById("search").addEventListener("keydown", function (e) {
  				if (e.key === "Enter") {
    			e.preventDefault();
    			searchRedirect();
  				}
			});
			/* Search - generate URL and redirect */
			function searchRedirect() {
 				const input = document.getElementById("search");
  				if (!input) return;
				const query = encodeURIComponent(input.value.trim());
  				const url = "https://duckduckgo.com/?q=site%3Amattcasmith.net+" + query;
				window.open(url, "_blank");
			}
        </script>
		
		</div>
	
	</body>
</html>