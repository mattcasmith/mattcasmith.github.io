<!doctype html>
<head>
	<meta name="description" content="" />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2017/12/18/grabbing-domains-and-urls-from-tcpdump-data-using-python/" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Grabbing domains and URLs from tcpdump data using Python | MattCASmith" />
	<meta property="og:description" content="" />
	<meta property="og:url" content="https://mattcasmith.net/2017/12/18/grabbing-domains-and-urls-from-tcpdump-data-using-python/" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2020-05-02T11:05:40+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2017/12/url-CC.jpg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>Grabbing domains and URLs from tcpdump data using Python | MattCASmith</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
			</div>
		</div>
		
		<article class="post">

			<div class="title">
				<h1 class="entry-title">Grabbing domains and URLs from tcpdump data using Python</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2017-12-18</span>&nbsp; 
					
					
						<a href="/category/programming/">Programming</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p><img src="/wp-content/uploads/2017/12/url-CC.jpg" /></p>

<p>There’s a lot more to most websites than meets the eye these days, and I thought an interesting Python project to take on at the start of my Christmas break would be to uncover the extra requests hidden below the surface with some help from tcpdump.<!--more--></p>

<p>The challenge? Tcpdump’s output is a huge list of the packets it captures, each one loaded with so much information that scanning the raw output for the domains and URLs that give away sites’ activity is near impossible. Luckily, Python has a few tricks up its sleeve that can help to filter out the data we need in a more readable format.</p>

<h3 id="setup-and-running-tcpdump">Setup and running tcpdump</h3>

<p>As usual, the first step is to get the basics set up. This means importing the os module and using it to run the tcpdump command that will give us some data to play with.</p>

<blockquote>
  <p>import os<br />
os.system(‘sudo tcpdump &gt; tcpdump_data’)</p>
</blockquote>

<p>I’ve gone for the vanilla version, but you could jazz this up by specifying ports or other network interfaces if needed. Everything that’s captured will be stored in a file called tcpdump_data, ready for us to start picking out the interesting bits.</p>

<h3 id="loading-the-data-and-defining-keywords">Loading the data and defining keywords</h3>

<p>Now the tcpdump process is complete and the data exists, it’s time to load it with Python (the “r” allows us to read the file) and define the keywords we’re looking for.</p>

<blockquote>
  <p>tcpdump_data = open(“tcpdump_data”, “r”)<br />
keyword1 = ‘HTTP: GET’<br />
keyword2 = ‘AAA?’</p>
</blockquote>

<p>I’m interested in seeing which websites have been browsed, so I want to pick out two key bits of data: DNS requests (preceded by “AAA?”), which will show the domains visited, and HTTP GET requests (preceded by “HTTP: GET”), which will show the individual directories and pages browsed, albeit only for sites that use HTTP and not HTTPS.</p>

<h3 id="defining-some-pretty-colours">Defining some pretty colours</h3>

<p>Although you could do fancier things with this kind of script, in my example both of these pieces of data will be displayed in one feed, so it’d be nice to show them in different colours to make them a bit easier to pick out. I’ll use purple and yellow.</p>

<blockquote>
  <p>class colours:<br />
     PURPLE = ‘\033[95m’<br />
     YELLOW = ‘\033[93m’</p>
</blockquote>

<p>I had to do a bit of Googling to work out how to do this. As usual, it was Stack Overflow that came up with solution – in this case <a href="https://stackoverflow.com/questions/287871/print-in-terminal-with-colors" target="_blank" rel="noopener">one that uses a simple class to define colours</a>.</p>

<h3 id="parsing-the-tcpdump-data">Parsing the tcpdump data</h3>

<p>Now it’s time to do the heavy work – parsing the tcpdump data we produced and opened earlier and picking out the domains and GET request paths that we come after our keywords.</p>

<blockquote>
  <p>for line in tcpdump_data:<br />
     if keyword1 in line:<br />
          data = line.split(“GET “, 1)[1]<br />
          print colours.PURPLE + data,<br />
     if keyword2 in line:<br />
          data = line.split(“AAA? “, 1)[1]<br />
          print colours.YELLOW + data,</p>
</blockquote>

<p>Here we iterate through the data line by line, looking for occurrences of “HTTP: GET” and “AAA?”. If one of these keywords exists in a line, the words after it (i.e. the domains and URL paths) will be printed to the terminal in some nice colours.</p>

<h3 id="output">Output</h3>

<p>The result is a list that gives us an interesting look at the requests that go on in the background when we visit websites – take the BBC News site, for example:</p>

<p><img src="/wp-content/uploads/2017/12/tcpdump.png" /></p>

<p>There’s plenty more potential here, too. These data sets could be written to separate files, for example, or stored in a way that more clearly shows the association between each entry. But my main objective was to see if I could scrape the relevant data and make it easier to read domains and URLs from tcpdump, and I’m happy with the result.</p>

<p><em>A note: I’m only just delving into the world of Python, and these posts are as much to get things straight in my own head as they are to show them to others. If anything looks wrong, or there’s a more efficient way of doing something, please let me know!</em></p>

<p><em>Photo © <a href="https://www.flickr.com/photos/chrisdlugosz/3402955869/in/photolist-6bH3dV-4kDjVr-qQuQvP-8QHv9A-dUYbzq-jbmBVr-7n9JVi-8Qdodn-6wSS2a-c3kMzo-booYXe-55hbBR-ec1LbL-eSyQUT-4wrCEc-7HS8Pq-jBz6En-dEx9r-6bH4b4-6bMaTY-6bMbxA-eadyjS-fj9EtK-2d2xQZ-dVVCLt-6NaSVz-q7qNqx-awSE9H-djDfML-a6yAjP-q9dqph-97Am4U-e6hmnE-dVDDb-811GuG-24nzDy-dZPFvC-2d2xPD-6Vq4rk-b8cT8K-2yprv-cmCQQ3-5ifGoh-4iMy64-fMKYPk-dVVHxD-a3jU4-6jarRB-bP73az-fN3ADE" target="_blank" rel="noopener">Chris Dlugosz</a> (<a href="https://creativecommons.org/licenses/by/2.0/" target="_blank" rel="noopener">CC BY 2.0</a>). Cropped.</em></p>

					<div id="newsletter_post">
	<h3>Field notes // A monthly newsletter on tech and design</h3>
	<p>No spam - just monthly updates and useful tidbits</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/cyber-security"><li class="first">Cyber Security</li></a>
		<a href="/category/technology"><li>Technology</li></a>
		<a href="/category/programming"><li>Programming</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/off-topic"><li>Off-Topic</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & projects</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/2021/01/01/backutil-windows-backup-utility" class="home-index"><li class="first">Backutil</li></a>
		<a href="/2022/12/03/parsing-login-sessions-windows-security-event-log-powershell" class="home-index"><li>EVTX login parser</li></a>
		<a href="/reading-list.htm" class="home-index"><li>Reading list</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
				                    	
				                        	
				                        		<a href="/2022/12/03/parsing-login-sessions-windows-security-event-log-powershell">
				                        			<li class="first">Parsing login sessions from the Windows event log with PowerShell</li>
					    	                	</a>
					    	                	
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/04/16/green-hills-outside-my-window">
				                        			<li>Finding comfort in the green hills outside my window</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/04/08/home-network-weak-wifi-slow-speeds">
				                        			<li>Fixing weak WiFi and slow speeds on my home network</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li>Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2022/12/15/investigating-explorer-temporary-zip-folders">
				                        			<li>Investigating Explorer's temporary ZIP folders and retrieving files</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/04/21/chatgpt-ai-anthropomorphism">
				                        			<li>Humanising AI encourages intellectual lethargy</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2022/02/22/bash-history-basics-behaviours-forensics">
				                        			<li>Linux .bash&#95;history&#58; Basics, behaviours, and forensics</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2023/11/26/modular-soc-centralisation-repeatability-automation">
				                        			<li>Centralisation, repeatability, and automation in a modular SOC</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2020/08/27/network-connections-packet-crafting-linux-command-line">
				                        			<li>Network connections and packet crafting on the Linux command line</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2023/02/17/winget-automate-software-deployment-new-laptop">
				                        			<li>Using winget to automate software deployment to a new laptop</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2023/01/13/2023-new-challenges-sharing-experiences">
				                        			<li>2023&#58; Thoughts on new challenges and sharing experiences</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2020/09/12/cracking-password-protected-zip-file-fcrackzip">
				                        			<li>Cracking a password-protected ZIP file with fcrackzip</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2023/03/26/cyber-security-learning-things-backwards">
				                        			<li>Cyber security sometimes means learning things backwards</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2022/01/08/sans-holiday-hack-2021-slot-machine">
				                        			<li>SANS Holiday Hack Challenge 2021&#58; Slot machine walkthrough</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2017/11/30/creating-beautiful-graphs-in-python-with-plotly/">&laquo;&nbsp;Creating beautiful graphs in Python with Plotly</a>
					
			</div>
			<div class="next">
			    
					<a href="/2017/12/28/what-ill-be-playing-and-reading-in-2018/">What I&#8217;ll be playing and reading in 2018&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-25 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
		
		</div>
	
	</body>
</html>