<!doctype html>
<html lang="en-GB">
<head>
	<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "BlogPosting",
		  "headline": "Investigating Explorer's temporary ZIP folders and retrieving files",
		  "description": "If I was to describe how often malware is downloaded within ZIP archives, ‚Äúcommon‚Äù would be a huge understatement. A key artefact in these investigations is the temporary directory Windows creates when a user opens an archive in Explorer, but I re...",
		  "author": {
		    "@type": "Person",
		    "name": "Matt C. A. Smith",
		    "url": "https://mattcasmith.net/about.htm"
		  },
		  "datePublished": "2022-12-14",
		  "dateModified": "2022-12-14",
		  "image": "https://mattcasmith.net/wp-content/uploads/2022/12/explorer-temporary-zip-folders_0.png",
		  "publisher": {
		    "@type": "Organization",
		    "name": "MattCASmith",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://mattcasmith.net/assets/images/mcas_site_logo.png"
		    }
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://mattcasmith.net/2022/12/14/investigating-explorer-temporary-zip-folders"
		  }
		}
	</script>
	<meta name="description" content="If I was to describe how often malware is downloaded within ZIP archives, ‚Äúcommon‚Äù would be a huge understatement. A key artefact in these investigations is the temporary directory Windows creates when a user opens an archive in Explorer, but I re..." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2022/12/14/investigating-explorer-temporary-zip-folders" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Investigating Explorer's temporary ZIP folders and retrieving files | MattCASmith" />
	<meta property="og:description" content="If I was to describe how often malware is downloaded within ZIP archives, ‚Äúcommon‚Äù would be a huge understatement. A key artefact in these investigations is the temporary directory Windows creates when a user opens an archive in Explorer, but I re..." />
	<meta property="og:url" content="https://mattcasmith.net/2022/12/14/investigating-explorer-temporary-zip-folders" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2022-12-14T00:00:00+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2022/12/explorer-temporary-zip-folders_0.png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
	<meta name="twitter:image" content="https://mattcasmith.net/wp-content/uploads/2022/12/explorer-temporary-zip-folders_0.png" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>Investigating Explorer's temporary ZIP folders and retrieving files | MattCASmith</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about light" src="/assets/images/about_icon.png" alt="About MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about dark" src="/assets/images/about_icon_dark.png" alt="About MattCASmith"></a>
			</div>
			<div id="search_cont">
				<input id="search" name="search" placeholder="Search site..." value="">
			</div>
		</div>
		
		<article class="post">

			<nav class="top_nav">
				<a href="/">HOME</a>
				<a href="/category/technology" >TECHNOLOGY</a>
				<a href="/category/business" >BUSINESS</a>
				<a href="/category/productivity" >PRODUCTIVITY</a>
				<a href="/category/design" >DESIGN</a>
				<a href="/category/cyber-security" >CYBER SECURITY</a>
				<a href="/category/programming" >CODING</a>
				<a href="/category/off-topic" >MISC</a>
			</nav>	

			<div class="title">
				<h1 class="entry-title">Investigating Explorer's temporary ZIP folders and retrieving files</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2022-12-14</span>&nbsp; 
					
					
						<a href="/category/cyber-security/">Cyber Security</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p>If I was to describe how often malware is downloaded within ZIP archives, ‚Äúcommon‚Äù would be a huge understatement. A key artefact in these investigations is the temporary directory Windows creates when a user opens an archive in Explorer, but I recently realised I‚Äôd never actually run a proper test to see when the folder is created, when it is not, and when it is deleted. So to clear that up, here‚Äôs a quick blog post.</p>

<h3 id="zip-archives-on-easy-mode">ZIP archives on easy mode</h3>

<p>There was a time when a ZIP archive was an indecipherable box that Windows couldn‚Äôt see inside. To access the files within, you‚Äôd have to download third-party software, like a trial version of WinZip that would incessantly prompt you to buy a licence whenever you downloaded something from the internet.</p>

<p>That all came to an end with - I <em>think</em>, although I may be slightly mistaken - Windows XP, when Microsoft added native capabilities within Windows Explorer to zip and unzip files. This is now a near-seamless experience, with the user able to open a ZIP archive as though it were a normal folder, as seen below.</p>

<p><img src="/wp-content/uploads/2022/12/explorer-temporary-zip-folders_1.png" /></p>

<p>But what‚Äôs going on behind the scenes when this happens, and what artefacts does it leave behind for forensicators and responders? With so much malware downloaded from the internet and attached to emails inside ZIP archives, knowing where to look can be a powerful tool in tracing user actions.</p>

<h3 id="the-amazing-disappearing-folder">The amazing disappearing folder</h3>

<p>This focus of this post is the temporary directory that Explorer creates, quietly unzipping parts of the archive on demand in the background so that it can present the user with that seamless interface on the front end. It‚Äôs located within the user‚Äôs <code>AppData</code> <code>Temp</code> folder, under a path like this:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">user</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span>\<span class="n">Temp1_zipname</span><span class="p">.</span><span class="nb">zip</span>\</code></pre></figure>

<p>But when exactly is the folder created? I previously assumed, wrongfully, that it would be created as soon as the user double-clicked the ZIP file in Explorer and viewed the directory listing within. However, that is not the case, and as long as the user stays within Explorer only, no folder is created.</p>

<p>As an aside, I‚Äôve noted that this also applies to nested folders within the ZIP archive - the user can browse them without triggering the <code>Temp1</code> folder creation. However, if the ZIP archive contains <em>another</em> ZIP archive and the user opens that with Explorer, a Temp1 folder is created for the <em>parent</em> archive.</p>

<p>The most common way a user will trigger the Temp1 folder‚Äôs creation, however, is by opening a file within the archive. This will create the folder and populate it with <em>only the file the user has actually opened</em>. Subsequent files are copied to the folder as they are opened by the user, but it‚Äôs worth noting that the <code>Temp1</code> folder <em>will not contain all files from the archive unless the user opens them all</em>.</p>

<p><img src="/wp-content/uploads/2022/12/explorer-temporary-zip-folders_2.png" /></p>

<p>These files are persistent regardless of whether the user closes them or opens other files. Interestingly, if the user makes changes to a file within the archive, by default the Save As dialogue box shows them the <code>Temp1</code> folder, meaning an inattentive user might actually end up saving their edited copies to the same location (although this is unlikely, as they would have to give their file a different name).</p>

<p>Once the <code>Temp1</code> folder is created, it remains in place for as long as the user has <em>any</em> ZIP archive open in Explorer. This is simple enough when working with one archive - the user closes the ZIP file and the <code>Temp1</code> folder disappears. But if the user opens files within <code>a.zip</code> and <code>b.zip</code>, then closes <code>b.zip</code>, the <code>Temp1</code> folders for <em>both</em> archives will remain until <code>a.zip</code> is also closed in Explorer.</p>

<p>It‚Äôs also worth noting here that the folder deletion doesn‚Äôt care about the files inside - it‚Äôll happen whether they‚Äôre still open or not. The only scenario I could find where specific files matter is if the user saves an edited copy of a file (with a different name, since the originals are read-only) inside the <code>Temp1</code> folder or moves a new file inside. If there‚Äôs a file that ‚Äúdoesn‚Äôt belong‚Äù at the time folder deletion is triggered, Explorer deletes the original files but leaves the directory and the ‚Äúcustom‚Äù files where they are.</p>

<p>Another short note, this time on naming: The temporary folders almost always start <code>Temp1</code>. In the previous example, there would be two folders named <code>Temp1_a.zip</code> and <code>Temp1_b.zip</code>. The only time the number increments is when dealing with two archives with <em>exactly the same name</em>. If the user opens files within two archives, both called <code>a.zip</code>, at the same time, Explorer creates <code>Temp1_a.zip</code> and <code>Temp2_a.zip</code>.</p>

<h3 id="summary">Summary</h3>

<p>Using the newfound knowledge from our experiments, we can draw up a rough guide to this behaviour and what your observations from log- and disk-based investigations might mean. As always, it‚Äôs best not to rely completely on this information and cross-reference with other artefacts wherever possible.</p>

<table>
  <tbody>
    <tr>
      <td><strong>Observed</strong></td>
      <td><strong>Inferred</strong></td>
    </tr>
    <tr>
      <td><code>Temp1</code> folder created</td>
      <td>User opened a file within the ZIP archive with Explorer</td>
    </tr>
    <tr>
      <td>File inside <code>Temp1</code> folder</td>
      <td>User opened this file from ZIP archive <em>OR</em> manually wrote it to folder</td>
    </tr>
    <tr>
      <td><code>Temp1</code> folder present</td>
      <td>User still has at least one ZIP archive open <em>OR</em> manually wrote a file inside</td>
    </tr>
    <tr>
      <td><code>Temp1</code> folder deleted</td>
      <td>User closed <em>all</em> open ZIP archives in Explorer</td>
    </tr>
    <tr>
      <td><code>Temp1</code> folder not created</td>
      <td>User did not open any files from ZIP archive in Explorer</td>
    </tr>
    <tr>
      <td><code>Temp2</code> folder created</td>
      <td>User opened files inside two identically named ZIP files with Explorer</td>
    </tr>
  </tbody>
</table>

					<div id="newsletter_post">
	<h3>Field Notes // A newsletter by MattCASmith</h3>
	<p>A monthly collection of observations, ideas in progress,<br />and the best books, podcasts, and articles I discover</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<a href="https://mattcasmith.beehiiv.com/subscribe" target="_blank">
<div id="newsletter_sidebar">
	<table>
		<tr>
			<td>
				<h3>üìì</h3>
			</td>
			<td>	
				<h2>Field Notes newsletter</h2>
			</td>
		</tr>
	</table>
	<p>A monthly collection of observations, ideas in progress, and the best books, podcasts, and articles I discover</p>
	<button>Subscribe</button>
</div>
</a>
<p class="newsletter_disclaimer">No spam. Unsubscribe anytime.</p>
				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/technology"><li class="first">Technology</li></a>
		<a href="/category/business"><li>Business</li></a>
		<a href="/category/productivity"><li>Productivity</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/cyber-security"><li>Cyber Security</li></a>
		<a href="/category/programming"><li>Coding</li></a>
		<a href="/category/off-topic"><li>Miscellaneous</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & pages</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/about.htm" class="home-index"><li class="first">About</li></a>
		<a href="/recommendations.htm" class="home-index"><li>Recommendations</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
				                    	
				                        	
				                        		<a href="/2025/04/21/chatgpt-ai-anthropomorphism">
				                        			<li class="first">Humanising AI encourages intellectual lethargy</li>
					    	                	</a>
					    	                	
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/26/etherhiding-blockchain-malware">
				                        			<li>EtherHiding&#58; When good blockchains turn bad</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/19/ai-security-operations-untapped-potential">
				                        			<li>The untapped potential of AI for security operations</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/11/field-notes-4-october-2025">
				                        			<li>Field Notes 4 // New York, note taking, and Blindr</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li>Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/05/anthropic-claude-ai-marketing-design">
				                        			<li>Claude's caf√© pop-up convinced me to switch LLMs</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/21/note-taking-waste-less-time-online">
				                        			<li>Take note&#58; How to waste less time on the internet</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/23/best-of-tech-2025">
				                        			<li>Best of Tech 2025&#58; Gadgets, books, games, and more</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/10/ai-shopping-profiling-privacy">
				                        			<li>AI shopping only works if you give up your privacy</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/01/self-driving-cars-buying-broken">
				                        			<li>Self-driving cars are here, but the friction is in the sale</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/02/time-blocking-productivity">
				                        			<li>Staying productive when everything feels urgent</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/02/chatgpt-atlas-ai-browser">
				                        			<li>ChatGPT Atlas positions AI as the internet's gatekeeper</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/03/new-york-observations-recommendations">
				                        			<li>New York City&#58; Observations and recommendations</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/31/abstraction-quality-detail-obsessed-leaders">
				                        			<li>Quality products begin with detail-obsessed leaders</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2022/12/03/parsing-login-sessions-windows-security-event-log-powershell">&laquo;&nbsp;Parsing login sessions from the Windows event log with PowerShell</a>
					
			</div>
			<div class="next">
			    
					<a href="/2023/01/13/2023-new-challenges-sharing-experiences">2023&#58; Thoughts on new challenges and sharing experiences&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-26 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script>
        	/* Search - allow submission using Enter key */
			document.getElementById("search").addEventListener("keydown", function (e) {
  				if (e.key === "Enter") {
    			e.preventDefault();
    			searchRedirect();
  				}
			});
			/* Search - generate URL and redirect */
			function searchRedirect() {
 				const input = document.getElementById("search");
  				if (!input) return;
				const query = encodeURIComponent(input.value.trim());
  				const url = "https://duckduckgo.com/?q=site%3Amattcasmith.net+" + query;
				window.open(url, "_blank");
			}
        </script>
		
		</div>
	
	</body>
</html>