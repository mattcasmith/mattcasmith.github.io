<!doctype html>
<html lang="en-GB">
<head>
	<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "BlogPosting",
		  "headline": "Automatically generating SOC emails with a Python script",
		  "description": "",
		  "author": {
		    "@type": "Person",
		    "name": "Matt C. A. Smith",
		    "url": "https://mattcasmith.net/about.htm"
		  },
		  "datePublished": "2018-04-29",
		  "dateModified": "2018-04-29",
		  "image": "https://mattcasmith.net/wp-content/uploads/2018/04/typing.jpg",
		  "publisher": {
		    "@type": "Organization",
		    "name": "MattCASmith",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://mattcasmith.net/assets/images/mcas_site_logo.png"
		    }
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://mattcasmith.net/2018/04/29/automatically-generating-soc-emails-with-a-python-script/"
		  }
		}
	</script>
	<meta name="description" content="" />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2018/04/29/automatically-generating-soc-emails-with-a-python-script/" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Automatically generating SOC emails with a Python script | MattCASmith" />
	<meta property="og:description" content="" />
	<meta property="og:url" content="https://mattcasmith.net/2018/04/29/automatically-generating-soc-emails-with-a-python-script/" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2018-04-29T14:47:37+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2018/04/typing.jpg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
	<meta name="twitter:image" content="https://mattcasmith.net/wp-content/uploads/2018/04/typing.jpg" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>Automatically generating SOC emails with a Python script | MattCASmith</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about light" src="/assets/images/about_icon.png" alt="About MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about dark" src="/assets/images/about_icon_dark.png" alt="About MattCASmith"></a>
			</div>
			<div id="search_cont">
				<input id="search" name="search" placeholder="Search site..." value="">
			</div>
		</div>
		
		<article class="post">

			<nav class="top_nav">
				<a href="/">HOME</a>
				<a href="/category/technology" >TECHNOLOGY</a>
				<a href="/category/business" >BUSINESS</a>
				<a href="/category/productivity" >PRODUCTIVITY</a>
				<a href="/category/design" >DESIGN</a>
				<a href="/category/cyber-security" >CYBER SECURITY</a>
				<a href="/category/programming" >CODING</a>
				<a href="/category/off-topic" >MISC</a>
			</nav>	

			<div class="title">
				<h1 class="entry-title">Automatically generating SOC emails with a Python script</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2018-04-29</span>&nbsp; 
					
					
						<a href="/category/cyber-security/">Cyber Security</a>,&nbsp;&nbsp;
					
						<a href="/category/programming/">Programming</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p><img src="/wp-content/uploads/2018/04/typing.jpg" /></p>

<p>The life of a SOC analyst ‚Äì as is the case with many other jobs ‚Äì can involve a lot of repetitive tasks, including the process of writing tens of similar emails each day. But what if this could be automated, saving time and reducing the potential for error?<!--more--></p>

<h3 id="the-email-template">The email template</h3>

<p>The most common email that a cyber security analyst has to send is to tell someone that there‚Äôs something wrong with their computer. The template looks something like this:</p>

<blockquote>
  <p>Dear Bob,</p>

  <p>We have detected the following suspicious activity on your computer, BOB_PC: Internet Explorer was run on Monday 16th April 2018 at 12:37:20 BST. Internet Explorer can be a legitimate application, but its use instead of an alternative like Firefox or Internet Explorer is not representative of normal user activity.</p>

  <p>Date and time: 16th April 2018 at 12:37:20 BST<br />
Hostname: BOB_PC<br />
File: C:\Program Files (x86)\Internet Explorer\iexplore.exe<br />
File hash: 259e27152180b895df395ed3e412b90e</p>

  <p>Your computer has been disconnected from the network and will require reimaging. Please contact IT to arrange this.</p>

  <p>Kind regards,<br />
Matt</p>
</blockquote>

<p>It‚Äôs a simple enough format, but when sending many of these each day (or even several at the same time) all that copying and pasting can take a while and lead to errors. What if I change the hostname in the list of technical details but forget to change it in the first sentence, for example? Some simple Python, involving little more than input prompts and variables, can help. Here‚Äôs how it works‚Ä¶</p>

<h3 id="getting-information-from-the-user">Getting information from the user</h3>

<p>First, let‚Äôs get the details we need from our SOC analyst. In this case, the email template includes the user‚Äôs name, the hostname, a description of the activity, the date and time it was detected, the file involved, and the file hash. To add a little complexity, let‚Äôs also assume there‚Äôs another possible scenario where the analyst is just asking for information.</p>

<blockquote>
  <p>user_name = raw_input(‚ÄúUser name: ‚Äú)<br />
detection_hostname = raw_input(‚ÄúHostname: ‚Äú)<br />
detection_description = raw_input(‚ÄúWe detected‚Ä¶ ‚Äú)<br />
detection_date = raw_input(‚ÄúDetection date: ‚Äú)<br />
detection_time = raw_input(‚ÄúDetection time: ‚Äú)<br />
detection_file = raw_input(‚ÄúFile path: ‚Äú)<br />
detection_hash = raw_input(‚ÄúFile hash: ‚Äú)<br />
disconnected = raw_input(‚ÄúDisconnected? (Y/N): ‚Äú)</p>
</blockquote>

<h3 id="setting-up-the-message-template">Setting up the message template</h3>

<p>Now the analyst has entered the necessary information, let‚Äôs establish the template and insert those variables. If your SOC has more than one email template then you could build in a menu or prompt to ask the user to choose between them, but in this case I‚Äôm going to move forward with just the one to keep this walkthrough a bit simpler.</p>

<blockquote>
  <p>message_1 = (‚ÄúDear %s,‚Äù % user_name)<br />
message_2 = (‚ÄúWe have detected the following suspicious activity on your computer, %s: %s‚Äù % (detection_hostname, detection_description))<br />
message_3 = (‚ÄúDate and time: %s at %s‚Äù % (detection_date, detection_time))<br />
message_4 = (‚ÄúHostname: %s‚Äù % detection_hostname)<br />
message_5 = (‚ÄúFile: %s‚Äù % detection_file)<br />
message_6 = (‚ÄúFile hash: %s‚Äù % detection_hash)<br />
message_7a = (‚ÄúYour computer has been disconnected from the network and will require reimaging. Please contact IT to arrange this.‚Äù)<br />
message_7b = (‚ÄúAre you aware of this activity and do you know why it took place?‚Äù)<br />
message_8 = (‚ÄúKind regards,‚Äù)<br />
message_9 = (‚ÄúMatt‚Äù)</p>
</blockquote>

<h3 id="putting-the-pieces-together">Putting the pieces together</h3>

<p>The final step is as simple as printing the relevant parts of the generated email to the screen (or a file, if you‚Äôd prefer) while using some simple logic to select the correct elements. To demonstrate how this works, I‚Äôll use both the previous decision between disconnecting and questioning the user, and I‚Äôll assume that our security tools don‚Äôt always give us a file hash.</p>

<blockquote>
  <p>print message_1<br />
print message_2<br />
print message_3<br />
print message_4<br />
print message_5</p>

  <p>if detection_hash == ‚Äú‚Äù:<br />
¬†¬†¬†¬† pass<br />
else:<br />
¬†¬†¬†¬† print message_6</p>

  <p>if disconnected == ‚ÄúY‚Äù or disconnected == ‚Äúy‚Äù:<br />
¬†¬†¬†¬† print message_7a<br />
else:<br />
¬†¬†¬†¬† print message_7b</p>

  <p>print message_8<br />
print message_9</p>
</blockquote>

<p>The hash line is only printed if a hash exists and the disconnection line is only printed if the analyst says the endpoint was disconnected. I‚Äôve removed the empty print lines to save space here, but feel free to add some to give your message some neat spacing.</p>

<h3 id="output">Output</h3>

<p>The result is a nice, automatically generated message that can be copied and pasted into an email or a SOC tool. The automated process speeds things up and reduces the chances that the analyst will make an error when sending many emails each day.</p>

<p><img src="/wp-content/uploads/2018/04/soc_message.png" /></p>

<p>Of course, this could all be taken a few steps further: the details of the detection could be pulled from a security tool API, for example, or the email could be automatically sent or fed to a SOC tool that would send it to the user. Perhaps I‚Äôll look into that in a future post.</p>

<p><em>A note: I‚Äôm only just delving into the world of Python, and these posts are as much to get things straight in my own head as they are to show them to others. If anything looks wrong, or there‚Äôs a more efficient way of doing something, please let me know!</em></p>

<p><em>Photo from <a href="https://www.pexels.com/photo/person-touching-open-macbook-on-table-839465/" target="_blank">Pexels</a> <a href="https://creativecommons.org/share-your-work/public-domain/cc0/" target="_blank">(CC0)</a>. Cropped.</em></p>

					<div id="newsletter_post">
	<h3>Field Notes // A newsletter by MattCASmith</h3>
	<p>A monthly collection of observations, ideas in progress,<br />and the best books, podcasts, and articles I discover</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<a href="https://mattcasmith.beehiiv.com/subscribe" target="_blank">
<div id="newsletter_sidebar">
	<table>
		<tr>
			<td>
				<h3>üìì</h3>
			</td>
			<td>	
				<h2>Field Notes newsletter</h2>
			</td>
		</tr>
	</table>
	<p>A monthly collection of observations, ideas in progress, and the best books, podcasts, and articles I discover</p>
	<button>Subscribe</button>
</div>
</a>
<p class="newsletter_disclaimer">No spam. Unsubscribe anytime.</p>
				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/technology"><li class="first">Technology</li></a>
		<a href="/category/business"><li>Business</li></a>
		<a href="/category/productivity"><li>Productivity</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/cyber-security"><li>Cyber Security</li></a>
		<a href="/category/programming"><li>Coding</li></a>
		<a href="/category/off-topic"><li>Miscellaneous</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & pages</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/about.htm" class="home-index"><li class="first">About</li></a>
		<a href="/recommendations.htm" class="home-index"><li>Recommendations</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li class="first">Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                	
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/02/chatgpt-atlas-ai-browser">
				                        			<li>ChatGPT Atlas positions AI as the internet's gatekeeper</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/26/etherhiding-blockchain-malware">
				                        			<li>EtherHiding&#58; When good blockchains turn bad</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/19/ai-security-operations-untapped-potential">
				                        			<li>The untapped potential of AI for security operations</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/11/field-notes-4-october-2025">
				                        			<li>Field Notes 4 // New York, note taking, and Blindr</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/10/travel-tourism-photos-experience">
				                        			<li>When you travel, the real journey isn't photographed</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/10/ai-shopping-profiling-privacy">
				                        			<li>AI shopping only works if you give up your privacy</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/01/self-driving-cars-buying-broken">
				                        			<li>Self-driving cars are here, but the friction is in the sale</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/09/field-notes-5-november-2025">
				                        			<li>Field Notes 5 // ChatGPT Atlas and the Claude cafeÃÅ</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/31/abstraction-quality-detail-obsessed-leaders">
				                        			<li>Quality products begin with detail-obsessed leaders</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/23/best-of-tech-2025">
				                        			<li>Best of Tech 2025&#58; Gadgets, books, games, and more</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/21/note-taking-waste-less-time-online">
				                        			<li>Take note&#58; How to waste less time on the internet</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/11/enshittification-football-chelsea-man-utd">
				                        			<li>Enshittified football needs its Steve Jobs moment</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/01/state-of-the-blog-2026">
				                        			<li>State of the Blog 2026&#58; Following a new direction</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2018/04/08/incident-triage-identifying-the-source-of-a-malware-infection/">&laquo;&nbsp;Incident triage: Identifying the source of a malware infection</a>
					
			</div>
			<div class="next">
			    
					<a href="/2018/05/07/stuff-i-did-in-april-isle-of-dogs-raf-museum-coffee-and-non-league-football/">Stuff I did in April: Isle of Dogs, RAF Museum, coffee and non-league football&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-26 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script>
        	/* Search - allow submission using Enter key */
			document.getElementById("search").addEventListener("keydown", function (e) {
  				if (e.key === "Enter") {
    			e.preventDefault();
    			searchRedirect();
  				}
			});
			/* Search - generate URL and redirect */
			function searchRedirect() {
 				const input = document.getElementById("search");
  				if (!input) return;
				const query = encodeURIComponent(input.value.trim());
  				const url = "https://duckduckgo.com/?q=site%3Amattcasmith.net+" + query;
				window.open(url, "_blank");
			}
        </script>
		
		</div>
	
	</body>
</html>