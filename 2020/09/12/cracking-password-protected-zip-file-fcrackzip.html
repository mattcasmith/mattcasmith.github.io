<!doctype html>
<html lang="en-GB">
<head>
	<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "BlogPosting",
		  "headline": "Cracking a password-protected ZIP file with fcrackzip",
		  "description": "I recently took part in a DFIR capture the flag with some colleagues. Participants were provided with a system disk image and asked to mount it and complete a number of challenges to discover various flags hidden within the data. Exercises like th...",
		  "author": {
		    "@type": "Person",
		    "name": "Matt C. A. Smith",
		    "url": "https://mattcasmith.net/about.htm"
		  },
		  "datePublished": "2020-09-12",
		  "dateModified": "2020-09-12",
		  "image": "https://mattcasmith.net/wp-content/uploads/2023/01/mcas.png",
		  "publisher": {
		    "@type": "Organization",
		    "name": "MattCASmith",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://mattcasmith.net/assets/images/mcas_site_logo.png"
		    }
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://mattcasmith.net/2020/09/12/cracking-password-protected-zip-file-fcrackzip"
		  }
		}
	</script>
	<meta name="description" content="I recently took part in a DFIR capture the flag with some colleagues. Participants were provided with a system disk image and asked to mount it and complete a number of challenges to discover various flags hidden within the data. Exercises like th..." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2020/09/12/cracking-password-protected-zip-file-fcrackzip" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Cracking a password-protected ZIP file with fcrackzip | MattCASmith" />
	<meta property="og:description" content="I recently took part in a DFIR capture the flag with some colleagues. Participants were provided with a system disk image and asked to mount it and complete a number of challenges to discover various flags hidden within the data. Exercises like th..." />
	<meta property="og:url" content="https://mattcasmith.net/2020/09/12/cracking-password-protected-zip-file-fcrackzip" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2020-09-12T00:00:00+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2023/01/mcas.png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
	<meta name="twitter:image" content="https://mattcasmith.net/wp-content/uploads/2023/01/mcas.png" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>Cracking a password-protected ZIP file with fcrackzip | MattCASmith</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about light" src="/assets/images/about_icon.png" alt="About MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about dark" src="/assets/images/about_icon_dark.png" alt="About MattCASmith"></a>
			</div>
			<div id="search_cont">
				<input id="search" name="search" placeholder="Search site..." value="">
			</div>
		</div>
		
		<article class="post">

			<nav class="top_nav">
				<a href="/">HOME</a>
				<a href="/category/technology" >TECHNOLOGY</a>
				<a href="/category/business" >BUSINESS</a>
				<a href="/category/productivity" >PRODUCTIVITY</a>
				<a href="/category/design" >DESIGN</a>
				<a href="/category/cyber-security" >CYBER SECURITY</a>
				<a href="/category/programming" >CODING</a>
				<a href="/category/off-topic" >MISC</a>
			</nav>	

			<div class="title">
				<h1 class="entry-title">Cracking a password-protected ZIP file with fcrackzip</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2020-09-12</span>&nbsp; 
					
					
						<a href="/category/cyber-security/">Cyber Security</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p>I recently took part in a DFIR capture the flag with some colleagues. Participants were provided with a system disk image and asked to mount it and complete a number of challenges to discover various flags hidden within the data. Exercises like this are always both a lot of fun and a good way to share knowledge and learn - after all, there‚Äôs no better time to pick up new techniques than in the heat of competition.</p>

<p>I got most of the answers and finished joint second. One of the questions I didn‚Äôt have time for, which I deprioritised as I would have needed to look up the methodology, involved discovering the password to an encrypted ZIP file to access the flag inside. To make sure I can complete similar challenges in future CTFs (or live scenarios), I decided to do some digging, crack a ZIP, and document my method.</p>

<h3 id="creating-a-password-protected-zip-archive">Creating a password-protected ZIP archive</h3>

<p>To emulate the conditions of the CTF, I needed to create a ZIP archive containing a text file with the would-be flag. Creating the text file is a simple as using <code>echo</code> to write some content to a file.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">echo</span> <span class="s">"This is a secret file."</span> <span class="o">&gt;</span> <span class="n">secretfile</span><span class="p">.</span><span class="n">txt</span></code></pre></figure>

<p>We can then use 7-Zip to create a password-protected ZIP archive. The <code>a</code> option tells 7-Zip that we‚Äôre adding files to an archive. We then specify the name of the archive and the file we wish to add. Finally, the <code>-p</code> option allows us to add a password - in this case, the very secure <code>thisisapassword</code>. Also note that the lack of a space isn‚Äôt a typo - that‚Äôs just the way 7-Zip wants the information to be provided.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="mi">7</span><span class="n">z</span> <span class="n">a</span> <span class="n">archive</span><span class="p">.</span><span class="nb">zip</span> <span class="n">secretfile</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">pthisisapassword</span></code></pre></figure>

<p>Now let‚Äôs check that the password was properly applied to the archive using the GUI. We can see that if we open <code>archive.zip</code>, we can see the file listing inside, but if we double-click to open any of the files we receive a prompt and cannot see the contents without entering the correct password.</p>

<p><img src="/wp-content/uploads/2020/09/fcrackzip_1.png" /></p>

<h3 id="cracking-the-password-protected-zip-archive-with-fcrackzip">Cracking the password-protected ZIP archive with fcrackzip</h3>

<p>The tool we‚Äôll use for discovering the password to our ZIP file is fcrackzip. We‚Äôll use the <code>-v</code> option to generate verbose output and keep track of what it‚Äôs doing, and <code>-u</code>, which tells fcrackzip to attempt to use the guessed password to unzip the file to verify that it is correct and reduce the risk of false positives.</p>

<p>We have two options as to how fcrackzip will attempt to guess the password. Firstly, we can use the <code>-b</code> option to perform a brute force attack, guessing every possible combination of characters. This is useful for cracking long, unique passwords, but not the quickest method if you think the password may actually just be a simple combination of words, numbers, and symbols.</p>

<p>For these scenarios, we‚Äôd be better off performing a dictionary attack with <code>-D</code>. This guesses the password by trying every entry in a list of passwords. As such, fcrackzip requires you to provide a dictionary to use with <code>-p</code>. We‚Äôll use <a href="https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt" target="_blank">the popular <code>rockyou.txt</code> dictionary</a> - a mainstay of the cyber security profession.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fcrackzip</span> <span class="o">-</span><span class="n">D</span> <span class="o">-</span><span class="n">p</span> <span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">u</span> <span class="n">archive</span><span class="p">.</span><span class="nb">zip</span></code></pre></figure>

<p>When we hit return, fcrackzip will begin trying every password in the dictionary. When one of them successfully unzips the archive, it will stop and tell us what it is. The duration of this process depends on the dictionary, your computer‚Äôs processing power, and the password‚Äôs complexity, but in our case the password is so simple that we see results almost instantly.</p>

<p><img src="/wp-content/uploads/2020/09/fcrackzip_2.png" /></p>

<p>To view the contents of the archive, all we would have to do is copy the password from the output, open the ZIP file in the Linux GUI, and paste it into the password field when prompted. Then voil√† - we‚Äôd have our flag, attacker-encrypted data, or any other files we were trying to access.</p>

					<div id="newsletter_post">
	<h3>Field Notes // A newsletter by MattCASmith</h3>
	<p>A monthly collection of observations, ideas in progress,<br />and the best books, podcasts, and articles I discover</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<a href="https://mattcasmith.beehiiv.com/subscribe" target="_blank">
<div id="newsletter_sidebar">
	<table>
		<tr>
			<td>
				<h3>üìì</h3>
			</td>
			<td>	
				<h2>Field Notes newsletter</h2>
			</td>
		</tr>
	</table>
	<p>A monthly collection of observations, ideas in progress, and the best books, podcasts, and articles I discover</p>
	<button>Subscribe</button>
</div>
</a>
<p class="newsletter_disclaimer">No spam. Unsubscribe anytime.</p>
				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/technology"><li class="first">Technology</li></a>
		<a href="/category/business"><li>Business</li></a>
		<a href="/category/productivity"><li>Productivity</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/cyber-security"><li>Cyber Security</li></a>
		<a href="/category/programming"><li>Coding</li></a>
		<a href="/category/off-topic"><li>Miscellaneous</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & pages</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/about.htm" class="home-index"><li class="first">About</li></a>
		<a href="/recommendations.htm" class="home-index"><li>Recommendations</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
									
									
				                    	
				                        	
				                        		<a href="/2025/11/09/field-notes-5-november-2025">
				                        			<li class="first">Field Notes 5 // ChatGPT Atlas and the Claude cafeÃÅ</li>
					    	                	</a>
					    	                	
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/02/chatgpt-atlas-ai-browser">
				                        			<li>ChatGPT Atlas positions AI as the internet's gatekeeper</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/26/etherhiding-blockchain-malware">
				                        			<li>EtherHiding&#58; When good blockchains turn bad</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/31/abstraction-quality-detail-obsessed-leaders">
				                        			<li>Quality products begin with detail-obsessed leaders</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/11/enshittification-football-chelsea-man-utd">
				                        			<li>Enshittified football needs its Steve Jobs moment</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/01/state-of-the-blog-2026">
				                        			<li>State of the Blog 2026&#58; Following a new direction</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/23/best-of-tech-2025">
				                        			<li>Best of Tech 2025&#58; Gadgets, books, games, and more</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/10/03/new-york-observations-recommendations">
				                        			<li>New York City&#58; Observations and recommendations</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/02/01/ai-deep-work-craftsmanship">
				                        			<li>AI could commodify thinking and destroy deep work</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/25/field-notes-6-january-2026">
				                        			<li>Field Notes 6 // Christmas, reflection, and bowling</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/18/x-algorithm-lists">
				                        			<li>How to opt out of X's engagement-first algorithm</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li>Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/01/self-driving-cars-buying-broken">
				                        			<li>Self-driving cars are here, but the friction is in the sale</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/13/you-can-just-do-things-kind-of">
				                        			<li>A reminder that you can just do things... kind of</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2020/09/02/network-connections-packet-crafting-linux-command-line">&laquo;&nbsp;Network connections and packet crafting on the Linux command line</a>
					
			</div>
			<div class="next">
			    
					<a href="/2020/11/15/aws-deploying-virtual-network-server-cloud">AWS&#58; Deploying a virtual network and server in the cloud&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-26 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script>
        	/* Search - allow submission using Enter key */
			document.getElementById("search").addEventListener("keydown", function (e) {
  				if (e.key === "Enter") {
    			e.preventDefault();
    			searchRedirect();
  				}
			});
			/* Search - generate URL and redirect */
			function searchRedirect() {
 				const input = document.getElementById("search");
  				if (!input) return;
				const query = encodeURIComponent(input.value.trim());
  				const url = "https://duckduckgo.com/?q=site%3Amattcasmith.net+" + query;
				window.open(url, "_blank");
			}
        </script>
		
		</div>
	
	</body>
</html>