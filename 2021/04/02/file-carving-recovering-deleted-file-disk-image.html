<!doctype html>
<html lang="en-GB">
<head>
	<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "BlogPosting",
		  "headline": "File carving&#58; Recovering a deleted file from a Windows disk image",
		  "description": "Most computer users assume that when they delete a file and empty the Recycle Bin, it‚Äôs gone forever. After all, if Windows doesn‚Äôt show us a file, it doesn‚Äôt exist anymore, right? Wrong. With the right tools and knowledge, forensics experts can f...",
		  "author": {
		    "@type": "Person",
		    "name": "Matt C. A. Smith",
		    "url": "https://mattcasmith.net/about.htm"
		  },
		  "datePublished": "2021-04-02",
		  "dateModified": "2021-04-02",
		  "image": "https://mattcasmith.net/wp-content/uploads/2021/04/deletedfile_hex.png",
		  "publisher": {
		    "@type": "Organization",
		    "name": "MattCASmith",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://mattcasmith.net/assets/images/mcas_site_logo.png"
		    }
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://mattcasmith.net/2021/04/02/file-carving-recovering-deleted-file-disk-image"
		  }
		}
	</script>
	<meta name="description" content="Most computer users assume that when they delete a file and empty the Recycle Bin, it‚Äôs gone forever. After all, if Windows doesn‚Äôt show us a file, it doesn‚Äôt exist anymore, right? Wrong. With the right tools and knowledge, forensics experts can f..." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://mattcasmith.net/2021/04/02/file-carving-recovering-deleted-file-disk-image" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="File carving&#58; Recovering a deleted file from a Windows disk image | MattCASmith" />
	<meta property="og:description" content="Most computer users assume that when they delete a file and empty the Recycle Bin, it‚Äôs gone forever. After all, if Windows doesn‚Äôt show us a file, it doesn‚Äôt exist anymore, right? Wrong. With the right tools and knowledge, forensics experts can f..." />
	<meta property="og:url" content="https://mattcasmith.net/2021/04/02/file-carving-recovering-deleted-file-disk-image" />
	<meta property="og:site_name" content="MattCASmith" />
	<meta property="article:published_time" content="2021-04-02T00:00:00+00:00" />
	<meta property="og:image" content="https://mattcasmith.net/wp-content/uploads/2021/04/deletedfile_hex.png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mattcasmith" />
	<meta name="twitter:site" content="@mattcasmith" />
	<meta name="twitter:image" content="https://mattcasmith.net/wp-content/uploads/2021/04/deletedfile_hex.png" />
</head>
	<head>
		<style>
			html {
				display: none;
			}
		</style>
		<title>File carving&#58; Recovering a deleted file from a Windows disk image | MattCASmith</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="/assets/images/favicon.png">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
	</head>
	
	<body>
		<div id="site-container" class="post">
		<div id="header">
			<div id="header_left">
				<a href="/"><img class="site_logo light" src="/assets/images/mcas_site_logo.png" alt="MattCASmith"></a>
				<a href="/"><img class="site_logo dark" src="/assets/images/mcas_site_logo_dark.png" alt="MattCASmith"></a>
				<a href="/"><h2>MattCASmith</h2></a>
			</div>
			<div id="header_right">
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter light" src="/assets/images/x_icon.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="https://x.com/mattcasmith"><img class="link_icon_twitter dark" src="/assets/images/x_icon_dark.png" alt="MattCASmith on X"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email light" src="/assets/images/email_icon.png" alt="Email MattCASmith"></a>
				<a target="_blank" href="mailto:mattcasmith@protonmail.com"><img class="link_icon_email dark" src="/assets/images/email_icon_dark.png" alt="Email MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about light" src="/assets/images/about_icon.png" alt="About MattCASmith"></a>
				<a href="/about.htm"><img class="link_icon_about dark" src="/assets/images/about_icon_dark.png" alt="About MattCASmith"></a>
			</div>
			<div id="search_cont">
				<input id="search" name="search" placeholder="Search site..." value="">
			</div>
		</div>
		
		<article class="post">

			<nav class="top_nav">
				<a href="/">HOME</a>
				<a href="/category/technology" >TECHNOLOGY</a>
				<a href="/category/business" >BUSINESS</a>
				<a href="/category/productivity" >PRODUCTIVITY</a>
				<a href="/category/design" >DESIGN</a>
				<a href="/category/cyber-security" >CYBER SECURITY</a>
				<a href="/category/programming" >CODING</a>
				<a href="/category/off-topic" >MISC</a>
			</nav>	

			<div class="title">
				<h1 class="entry-title">File carving&#58; Recovering a deleted file from a Windows disk image</h1>
			</div>
			
			<div class="meta">
				<span class="year_label">2021-04-02</span>&nbsp; 
					
					
						<a href="/category/cyber-security/">Cyber Security</a>
					
				
			</div>

			<div class="post_content_container_ext">

				<div class="post_content_container_int">
					<p>Most computer users assume that when they delete a file and empty the Recycle Bin, it‚Äôs gone forever. After all, if Windows doesn‚Äôt show us a file, it doesn‚Äôt exist anymore, right? Wrong. With the right tools and knowledge, forensics experts can find fragments - or even complete versions - of deleted files that remain on the hard disk long after they disappear from Windows Explorer.</p>

<p>In this post, I‚Äôll run through how to take a disk image and recover deleted files using FTK Imager and a hex editor, explain why this works, and show how certain utilities let you overwrite this remnant data.</p>

<h3 id="what-happens-when-you-delete-a-file">What happens when you delete a file?</h3>

<p>To give myself something to find, I created the text file shown below on a 2GB hard drive partition. I saved it, then closed it, deleted it, and emptied the Recycle Bin to render it inaccessible to any normal Windows user. But what is actually happening in the background when you do this?</p>

<p><img src="/wp-content/uploads/2021/04/deletedfile_file.png" /></p>

<p>At the top of your hard drive is what‚Äôs known as the master file table (MFT). This is essentially an index - it contains filenames along with the addresses on the hard drive that these files can be found at. So when I create <code>test_file.txt</code>, an MFT record is created containing that filename and the address where the data (i.e. the file contents) is stored - in this case that‚Äôs <code>40009D50h</code>, but we don‚Äôt know that yet.</p>

<p>When you delete a file, none of this information is removed from the disk. All deletion does is add a ‚Äúdeleted‚Äù flag to the MFT record, telling the computer that the information at the specified address is no longer needed and can be overwritten with new data if necessary - but nothing is actually deleted at this point and the file data is still present on the disk. You can probably guess where this is going‚Ä¶</p>

<h3 id="creating-a-disk-image-with-ftk-imager">Creating a disk image with FTK Imager</h3>

<p>With the right tools, we can access the remnant data. First, we need a physical disk image to work with. <a href="https://accessdata.com/product-download" target="_blank">FTK Imager</a> is a free tool that allows us to create one. We choose a few simple options (I‚Äôm generating an image in the <code>E01</code> format) and set it to work. Depending on the size of the disk and your computer‚Äôs speed, it will take a little while to generate the image, which is an exact replica of the hard drive.</p>

<p><img src="/wp-content/uploads/2021/04/deletedfile_ftk.png" /></p>

<p>One thing to note is that the image cannot be generated on the same physical hard drive that is being imaged. For this reason, unless the system has multiple hard drives, it is necessary to choose to save the image to a directory on a removable drive or a network share, rather than on the subject computer itself.</p>

<h3 id="recovering-a-deleted-file-with-ftk-imager">Recovering a deleted file with FTK Imager</h3>

<p>FTK Imager can also be useful for the next step in our process - it can actually do the hard work for us and recover the deleted file. If we mount the physical image we created and open the correct partition, we can navigate through the file system to find deleted files, which will be marked with a red cross.</p>

<p><img src="/wp-content/uploads/2021/04/deletedfile_ftkrecover.png" /></p>

<p>As the last place the file was present was the Recycle Bin (read my post about <a href="/2018/12/15/python-windows-forensics-recycle-bin-deleted-files/">Python forensics for the Recycle Bin</a> for more information about the file structure), its MFT entry points to that directory. Here, we can see that the file <code>$RHEYFYA.txt</code> is our test file, and FTK Imager helpfully displays the contents.</p>

<h3 id="recovering-a-deleted-file-with-a-hex-editor">Recovering a deleted file with a hex editor</h3>

<p>But things won‚Äôt always be that easy, and we shouldn‚Äôt rely on tools to do our forensics for us without knowing how they work. We can find the same data manually by mounting the disk image and opening it in a hex editor - in this example, <a href="https://www.sweetscape.com/010editor/" target="_blank">010 Editor</a>. This displays the entire contents of the hard drive in hex format, and has a helpful feature that will search for strings amongst the data in the image.</p>

<p><img src="/wp-content/uploads/2021/04/deletedfile_hex.png" /></p>

<p>As you can see, I was able to find the text file‚Äôs contents by searching for strings. If we were looking for a different type of file, we might search according to its file signature, which indicates what format the file is in (for example, JPEGs start with <code>FF D8 FF E0</code>). Text files don‚Äôt normally have signatures, and in this case we can see the file data starts immediately at the address <code>40009D50h</code>.</p>

<h3 id="overwriting-traces-of-deleted-files">Overwriting traces of deleted files</h3>

<p>So we‚Äôve seen that it‚Äôs possible to recover deleted files, but is there any way to remove them  from the disk completely? In short: yes, there is. Tools like <a href="https://www.ccleaner.com/" target="_blank">CCleaner</a> can overwrite the free space on a hard drive with nonsense data. If I run CCleaner‚Äôs Drive Wiper feature on our partition and repeat the above process, we can see that the address formerly occupied by <code>test_file.txt</code> is now full of zeroes.</p>

<p><img src="/wp-content/uploads/2021/04/deletedfile_ccleaner.png" /></p>

<p>While this prevents a forensic investigator from recovering a file‚Äôs contents if done correctly, using some of these tools will arouse suspicion in itself. Some wipers will fill free space with ones, Zs, or random data, and this does not normally occur naturally. If this is observed on a hard drive then questions will be asked over whether the user was trying to hide something and a more thorough search may be conducted.</p>


					<div id="newsletter_post">
	<h3>Field Notes // A newsletter by MattCASmith</h3>
	<p>A monthly collection of observations, ideas in progress,<br />and the best books, podcasts, and articles I discover</p>
	<iframe src="https://embeds.beehiiv.com/77e2fe29-a7bd-4886-9f77-4370f9ad2ee9?slim=true" data-test-id="beehiiv-embed" height="53" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>
</div>

<div id="cta">
	If this article resonated, feel free to share it with someone who might appreciate it too. If you have thoughts, opinions, or comments to share then I'd love to hear from you - feel free to send me <a href="https://x.com/mattcasmith" target="_blank">a message on X</a> or <a href="mailto:mattcasmith@protonmail.com">an email</a>.
</div>
				</div>

				<a href="https://mattcasmith.beehiiv.com/subscribe" target="_blank">
<div id="newsletter_sidebar">
	<table>
		<tr>
			<td>
				<h3>üìì</h3>
			</td>
			<td>	
				<h2>Field Notes newsletter</h2>
			</td>
		</tr>
	</table>
	<p>A monthly collection of observations, ideas in progress, and the best books, podcasts, and articles I discover</p>
	<button>Subscribe</button>
</div>
</a>
<p class="newsletter_disclaimer">No spam. Unsubscribe anytime.</p>
				<div id="home_sidebar">
					<div id="home_about_boxes">
						<div class="home_about_box home_box">
							<h2>Categories</h2>
							<div id="side_menu">
	<ul class="side_menu">
		<a href="/category/technology"><li class="first">Technology</li></a>
		<a href="/category/business"><li>Business</li></a>
		<a href="/category/productivity"><li>Productivity</li></a>
		<a href="/category/design"><li>Design</li></a>
		<a href="/category/cyber-security"><li>Cyber Security</li></a>
		<a href="/category/programming"><li>Coding</li></a>
		<a href="/category/off-topic"><li>Miscellaneous</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Index & pages</h2>
							<a href="/blog-index.htm"><div class="home-button green-button">Blog index</div></a>
<div id="side_menu">
	<ul class="side_menu">
		<a href="/about.htm" class="home-index"><li class="first">About</li></a>
		<a href="/recommendations.htm" class="home-index"><li>Recommendations</li></a>
	</ul>
</div>
						</div>
						<div class="home_about_box home_box">
							<h2>Other posts</h2>
							<div id="other_posts_list">
							<ul class="other_posts_list">
								
								
								
								
								
								
								
									
									
									
				                    	
				                        	
				                        		<a href="/2025/09/21/note-taking-waste-less-time-online">
				                        			<li class="first">Take note&#58; How to waste less time on the internet</li>
					    	                	</a>
					    	                	
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2026/01/01/state-of-the-blog-2026">
				                        			<li>State of the Blog 2026&#58; Following a new direction</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/23/best-of-tech-2025">
				                        			<li>Best of Tech 2025&#58; Gadgets, books, games, and more</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/10/ai-shopping-profiling-privacy">
				                        			<li>AI shopping only works if you give up your privacy</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2024/07/20/crowdstrike-bug-edr-setting-record-straight">
				                        			<li>Endpoint detection and response (EDR) - setting the record straight</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/26/etherhiding-blockchain-malware">
				                        			<li>EtherHiding&#58; When good blockchains turn bad</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/19/ai-security-operations-untapped-potential">
				                        			<li>The untapped potential of AI for security operations</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/11/field-notes-4-october-2025">
				                        			<li>Field Notes 4 // New York, note taking, and Blindr</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/10/travel-tourism-photos-experience">
				                        			<li>When you travel, the real journey isn't photographed</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/12/01/self-driving-cars-buying-broken">
				                        			<li>Self-driving cars are here, but the friction is in the sale</li>
					    	                	</a>
					    	                          
				                    		
					                    	
					                    
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/09/field-notes-5-november-2025">
				                        			<li>Field Notes 5 // ChatGPT Atlas and the Claude cafeÃÅ</li>
					    	                	</a>
					    	                       
				                    		
				                    		
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/11/02/chatgpt-atlas-ai-browser">
				                        			<li>ChatGPT Atlas positions AI as the internet's gatekeeper</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
						    	
									
									
									
									
									
				                    	
				                	
				                	
									
									
				                    	
				                	
				                	
									
									
				                    	
				                        	
				                        		<a href="/2025/10/05/anthropic-claude-ai-marketing-design">
				                        			<li>Claude's caf√© pop-up convinced me to switch LLMs</li>
					    	                	</a>
					    	                         
				                    		
				                    		
				                    	
				                	
						    	
									
									
									
				                    	
				                        	
				                        		<a href="/2025/05/31/abstraction-quality-detail-obsessed-leaders">
				                        			<li>Quality products begin with detail-obsessed leaders</li>
					    	                	</a>
					    	                        
					                    	
					                    	
				                    	
				                	
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
									
									
									
									
									
				                	
									
									
				                	
									
									
						    	
					    	</ul>
				    		</div>
						</div>
					</div>
				</div>

			</div>

		</article>

		<div id="prev_next">
			<div class="prev">
				    
						<a href="/2021/03/26/sqlite-databases-python">&laquo;&nbsp;Backutil development&#58; Building and JOINing SQLite databases in Python</a>
					
			</div>
			<div class="next">
			    
					<a href="/2021/05/01/installing-splunk-free-virtual-machine-log-analysis">Installing Splunk Free in a virtual machine for log analysis&nbsp;&raquo;</a>
				
			</div>
		</div>

				<div id="footer">
			&copy; 2016-26 MattCASmith
			<span class="home-link">Personal blog - does not reflect views of employers past or present</span>
		</div>
		
		<script data-goatcounter="https://mattcasmith.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script>
        	/* Search - allow submission using Enter key */
			document.getElementById("search").addEventListener("keydown", function (e) {
  				if (e.key === "Enter") {
    			e.preventDefault();
    			searchRedirect();
  				}
			});
			/* Search - generate URL and redirect */
			function searchRedirect() {
 				const input = document.getElementById("search");
  				if (!input) return;
				const query = encodeURIComponent(input.value.trim());
  				const url = "https://duckduckgo.com/?q=site%3Amattcasmith.net+" + query;
				window.open(url, "_blank");
			}
        </script>
		
		</div>
	
	</body>
</html>